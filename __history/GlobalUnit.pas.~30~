unit GlobalUnit;

interface

var UsuarioLogado: String;
var EmpresaLogada: String;
procedure FecharTela(Sender: TObject);

implementation

Uses System.SysUtils, Vcl.ComCtrls, Vcl.Controls, Vcl.Forms;

procedure FecharTela(Sender: TObject);
var
  Ctrl: TControl;
  TabSheet: TTabSheet;
begin
  if not (Sender is TControl) then
    Exit;

  // Se for um TForm, usa ele mesmo
  if Sender is TForm then
    Ctrl := TForm(Sender)
  else
    Ctrl := TControl(Sender);

  // Encontra a TabSheet pai e FECHA
  while Assigned(Ctrl.Parent) do
  begin
    if Ctrl.Parent is TTabSheet then
    begin
      TabSheet := TTabSheet(Ctrl.Parent);
      TabSheet.Free;  // FECHA A PORRA DA ABA
      Exit;
    end;
    Ctrl := Ctrl.Parent;
  end;
end;

end.
