unit GlobalUnit;

interface

var UsuarioLogado: String;
var EmpresaLogada: String;
procedure FecharTela(Sender: TObject);

implementation

Uses Vcl.ComCtrls, Vcl.Controls;

procedure FecharTela(Sender: TObject);
var
  TabSheet: TTabSheet;
begin
  // Garante que o Sender é um controle
  if Sender is TControl then
  begin
    // Sobe a hierarquia até achar um TTabSheet
    if (TControl(Sender).Parent is TTabSheet) then
    begin
      TabSheet := TControl(Sender).Parent as TTabSheet;
      TabSheet.PageControl := nil;
      TabSheet.Free;
    end;
  end;
end;
end.
