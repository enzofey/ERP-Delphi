unit GlobalUnit;

interface

var UsuarioLogado: String;
var EmpresaLogada: String;
procedure FecharTela(Sender: TObject);

implementation

Uses System.SysUtils, Vcl.ComCtrls, Vcl.Controls, Vcl.Forms;

procedure FecharTela(Sender: TObject);
var
  Ctrl: TControl;
  Frm: TForm;
begin
  if not (Sender is TControl) then
    Exit;

  Ctrl := TControl(Sender);

  while Assigned(Ctrl.Parent) do
    Ctrl := Ctrl.Parent;

  if Ctrl is TForm then
  begin
    Frm := TForm(Ctrl);
    if Frm <> Application.MainForm then
      Frm.Close; // Fecha apenas se não for o MainForm
  end;
end;
end.
